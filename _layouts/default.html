<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if page.title %}{{ page.title }} - {% endif %}{{ site.title }}</title>
    <meta name="description" content="{{ site.description }}">

    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">

    <!-- MathJax for mathematical notation -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Google Analytics (optional) -->
    {% if site.analytics.google.tracking_id %}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.analytics.google.tracking_id }}"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '{{ site.analytics.google.tracking_id }}');
    </script>
    {% endif %}
</head>
<body>
    <!-- Masthead with site title (mobile only) -->
    <div class="masthead">
        <div class="masthead-inner">
            <a href="{{ '/' | relative_url }}">{{ site.title | upcase }}</a>
        </div>
    </div>

    <!-- Main layout container -->
    <div class="page-wrapper">
        <!-- Sidebar -->
        {% include sidebar.html %}

        <!-- Main content area -->
        <div class="main-content">
            <article>
                {{ content }}
            </article>

            <!-- Footer -->
            {% include footer.html %}
        </div>
    </div>

    <!-- Scroll effect for masthead - hide on scroll down, show on scroll up -->
    <script>
        var lastScrollTop = 0;
        var masthead = document.querySelector('.masthead');

        window.addEventListener('scroll', function() {
            var scrollTop = window.pageYOffset || document.documentElement.scrollTop;

            if (scrollTop > lastScrollTop && scrollTop > 100) {
                // Scrolling down & past 100px - hide masthead
                masthead.classList.add('hidden');
            } else {
                // Scrolling up or near top - show masthead
                masthead.classList.remove('hidden');
            }

            lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
        }, false);
    </script>

    <!-- Make all external links and PDFs open in new tab -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get all links on the page
            var links = document.querySelectorAll('a');

            links.forEach(function(link) {
                var href = link.getAttribute('href');

                // Skip if no href
                if (!href) return;

                // Check if link is external or PDF
                var isExternal = href.startsWith('http') || href.startsWith('//');
                var isPDF = href.endsWith('.pdf');

                // Add target="_blank" to external links and PDFs
                if (isExternal || isPDF) {
                    link.setAttribute('target', '_blank');
                    link.setAttribute('rel', 'noopener noreferrer');
                }
            });
        });
    </script>
</body>
</html>
